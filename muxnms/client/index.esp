<!DOCTYPE html>
<html lang="en">
<head>
    <title>数字网管</title>
    <meta charset="utf-8" />
    <link rel="icon" href="img/favicon.ico" type="image/x-icon">    
    <link rel="stylesheet" href="css/ui.fancytree.min.css" type="text/css"> 
    <link rel="stylesheet" href="css/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="css/jquery.dataTables.min.css" type="text/css">
    <link rel="stylesheet" href="css/all.css" type="text/css">
</head>
<body>
	<div class="navbar">
		<nav>
			<label>数字设备网管</label>
		</nav>
    </div>
    <div class="container">
		<div class="l-sidebar">	  
			<div class="ny_zb">
				<div class="ny_zblb1">
					<ul class="clearfix">
                        <li id="l1">
                            <a class="cur ipinmode" href="javascript:createIPINUI()"><strong>IP输入</strong></a>
                        </li>
						<li id="l2">
							<a class="cur ipoutmode" href="javascript:createHomeUI()"><strong>节目列表</strong></a>
						</li>
						<li class="subs" id="l3">
							<a class="flag ipoutmode" href="javascript:createSendSrcUI()"><strong>发送源</strong></a>
						</li>
						<li class="subs" id="l4">
							<a class="flag" href="javascript:createDevFuncUI()"><strong>设备功能</strong></a>
						</li>
						<li class="subs" id="l5">
							<a class="flag" href="javascript:void(0)"><strong>设备管理</strong></a>
							<ul>
                                <li id="l51"><a href="javascript:gbl_setIp()">IP地址设置</a></li>
                                <li id="l52"><a href="javascript:gbl_reset()">恢复出厂设置</a></li>
                                <li id="l53"><a href="javascript:gbl_restart()">重启设备</a></li>
                                <li id="l54"><a href="javascript:gbl_password()">修改密码</a></li>
                            </ul>
                        </li>
                        <li class="subs" id="l6">
                            <a class="flag" href="javascript:void(0)"><strong>日志记录</strong></a>
                            <ul>
                                <li id="l61"><a href="javascript:alarm_output(2)">操作日志</a></li>
                             </ul>
                         </li>
                         <li id="l7">
                            <!-- <a href="javascript:void(0)" class="STRING_HELP"><strong>帮助</strong></a> -->
                         </li>
                         <li id="l8">
                             <a href="javascript:btn_close()" class="STRING_EXIT"><strong>退出</strong></a>
                         </li>
                     </ul>
                 </div>

             </div>
         </div>
         <div class="main-content">
             <!--  CONTENT  -->
		</div>
        <div id="progress-notification" title="通知">
            <p class="notification-tips"></p>
        </div>
    </div>
	<div class="footer">
		<hr/>
		<p> <%= mprGetDate(0); %></p>
		<p>© Prevail Software, 2014-2024.V0.1.0 All rights reserved.</p>
	</div>
    <script type="text/javascript" src="lib/jquery.min.js"></script>
    <script type="text/javascript" src="lib/jquery-ui.min.js"></script>
    <script type="text/javascript" src="lib/jquery.fancytree.min.js"></script>    
    <script type="text/javascript" src="lib/jquery.dataTables.min.js"></script>
	<script type="text/javascript" src="js/global.js"></script> 
	<script type="text/javascript" src="js/alarm.js"></script> 
	<script type="text/javascript" src="js/devinfo.js"></script>
	<script src="lib/jquery.popup.js" type="text/javascript"></script>
	<script src="lib/jquery.fancytree.menu.js" type="text/javascript"></script>
    <script type="text/javascript">		
		var localip = window.location.href.substr(7, window.location.href.indexOf(':', 7) - 7);
        //var devmode;
		var os = getOS();
		function getOS(){
            var str=navigator.userAgent;
            var BrowserS=['MSIE 9.0','MSIE 8.0','MSIE 7.0','MSIE6.0',
                'Firefox','Opera','Chrome'];
            for(var i=0;i<BrowserS.length;i++){
                if(str.indexOf(BrowserS[i])>=0){return BrowserS[i].replace('MSIE','IE');}
            }
		}
        $.ajax({
            type: "GET",
            async: false,
            url: "http://"+localip+":4000/do/programs/getdevNetFun",
            dataType: "json",
            success: function(res){
                if(res.sts == 8){
                    window.location = "/login.esp";
                }else{
                    if(res.mode == 0){
                        $('.ipinmode').css("display", "none");
                        $('.ipoutmode').css("display", "");
                        createHomeUI();
                    }else{
                        $('.ipinmode').css("display", "");
                        $('.ipoutmode').css("display", "none");
                        createIPINUI();
                    }
                }
            },
            error : function(err) {
            }
        });
//
//        function toHome() {
//            if(globalObj.timerID != undefined){
//                clearInterval(globalObj.timerID);
//            }
//            //获取设备基本信息
//            $.ajax({
//                type: "GET",
//                async:false,
//                url: "http://"+localip+":4000/do/programs/getDevinfo",
//                dataType: "json",
//                success: function(data){
//                    recdata = data;
//                },
//                error : function(err) {
//                }
//            });
//            //
//            //
//            $('.main-content').empty();
//            $('.main-content').append(
//                    '<table id="basedev" class="tbl_baseinfo" cellspacing="0" width="100%">'
//                    +'<tbody>'
//                    +'<tr>'
//                    +'<th><label>名称:</label></th>'
//                    +'<th><label id="dev-name" class="tbl_th">T'+recdata.IP+'</label></th>'
//                    +'</tr>'
//                    +'<tr>'
//                    +'<th><label>类型:</label></th>'
//                    +'<th><label id="dev-type" class="tbl_th">'+recdata.devType+'</label></th>'
//                    +'</tr>'
//                    +'<tr>'
//                    +'<th><label>有效性:</label></th>'
//                    +'<th><label id="dev-valid" class="tbl_th">是</label></th>'
//                    +'</tr>'
//                    +'<tr>'
//                    +'<th><label>链接方式:</label></th>'
//                    +'<th><label id="dev-connect" class="tbl_th">TCP</label></th>'
//                    +'</tr>'
//                    +'<tr>'
//                    +'<th><label>网络地址:</label></th>'
//                    +'<th><label id="dev-ip" class="tbl_th">'+recdata.IP+'</label></th>'
//                    +'</tr>'
//                    +'<tr>'
//                    +'<th><label>端口号:</label></th>'
//                    +'<th><label id="dev-port" class="tbl_th">'+recdata.port+'</label></th>'
//                    +'</tr>'
//                    +'<tr>'
//                    +'<th><label>硬件版本:</label></th>'
//                    +'<th><label id="dev-biosversion" class="tbl_th">'+recdata.HardVersion+'</label></th>'
//                    +'</tr>'
//                    +'<tr>'
//                    +'<th><label>软件版本:</label></th>'
//                    +'<th><label id="dev-softversion" class="tbl_th">'+recdata.SoftVersion+'</label></th>'
//                    +'</tr>'
//                    +'<tr>'
//                    +'<th><label>固件版本:</label></th>'
//                    +'<th><label id="dev-firmware" class="tbl_th">'+recdata.FpgaVersion+'</label></th>'
//                    +'</tr>'
//                    +'</tbody>'
//                    +'</table>'
//            );
//        }
//        try{
//            $("#dev-name")[0].textContent = "T"+recdata.IP;
//            $("#dev-type")[0].textContent = recdata.devType;
//            $("#dev-valid")[0].textContent = "是";
//            $("#dev-connect")[0].textContent = "TCP";
//            $("#dev-ip")[0].textContent = recdata.IP;
//            $("#dev-port")[0].textContent = recdata.port;
//            $("#dev-biosversion")[0].textContent = recdata.HardVersion;
//            $("#dev-softversion")[0].textContent = recdata.SoftVersion;
//            $("#dev-firmware")[0].textContent = recdata.FpgaVersion;
//        }catch(err){
//
//        }

		function btn_close() {
			var userAgent = navigator.userAgent;
			//注销				
			$.ajax({
				 type: "GET",
				 async:false,
				 url: "http://"+localip+":4000/do/login/logout",
				 dataType: "text",
				 success: function(data){
					
				 },    
				 error : function(err) {    
   
				 }   
			});
			if (userAgent.indexOf("Firefox") != -1 || userAgent.indexOf("Presto") != -1) {
				window.location.replace("about:blank");
			} else {
				window.opener = null;
				window.open("", "_self");
				window.close();
			}
		}
		
		$(function(){						
			$(".ny_zblb1 ul li").click(function(){
				var thisSpan=$(this);
				$(".ny_zblb1 a").removeClass("cur");
				$(this).children("a").addClass("cur");
				$(this).children("ul").slideDown("fast");
				$(this).siblings().children("ul").slideUp("fast");
			});
		});
    </script> 
</body>
</html>
